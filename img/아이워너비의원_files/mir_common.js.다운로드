// ie8 이하 console 에러를 막기 위한 코드
var console = window.console || { log: function() {} };

// jquery sortable item array injection function do not delete very important
jQuery.fn.extend({
    cycle: function (fn) {
        var args = arguments,
		guid = fn.guid || jQuery.guid++,
		i = 0,
		toggler = function (event) {
		    // Figure out which function to execute
		    var lastToggle = (jQuery._data(this, "lastToggle" + fn.guid) || 0) % i;
		    jQuery._data(this, "lastToggle" + fn.guid, lastToggle + 1);

		    // Make sure that clicks stop
		    event.preventDefault();

		    // and execute the function
		    return args[lastToggle].apply(this, arguments) || false;
		};

        // link all the functions, so any of them can unbind this click handler
        toggler.guid = guid;
        while (i < args.length) {
            args[i++].guid = guid;
        }

        return this.click(toggler);
    }
});

// $('img.photo',this).imagesLoaded(myFunction)
// execute a callback when all images have loaded.
// needed because .load() doesn't work on cached images

// Modified with a two-pass approach to changing image
// src. First, the proxy imagedata is set, which leads
// to the first callback being triggered, which resets
// imagedata to the original src, which fires the final,
// user defined callback.

// modified by yiannis chatzikonstantinou.

// original:
// mit license. paul irish. 2010.
// webkit fix from Oren Solomianik. thx!

// callback function is passed the last image to load
//   as an argument, and the collection as `this`


$.fn.imagesLoaded = function( callback ){
  var elems = this.find( 'img' ),
      elems_src = [],
      self = this,
      len = elems.length;

  if ( !elems.length ) {
    callback.call( this );
    return this;
  }

  elems.one('load error', function() {
    if ( --len === 0 ) {
      // Rinse and repeat.
      len = elems.length;
      elems.one( 'load error', function() {
        if ( --len === 0 ) {
          callback.call( self );
        }
      }).each(function() {
        this.src = elems_src.shift();
      });
    }
  }).each(function() {
    elems_src.push( this.src );
    // webkit hack from http://groups.google.com/group/jquery-dev/browse_thread/thread/eee6ab7b2da50e1f
    // data uri bypasses webkit log warning (thx doug jones)
    this.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
  });

  return this;
};

function encodeAll(s) { 
	return encodeURIComponent(s).replace(/[!'()*]/g, escape); // escape시킬 문자를 추가지정 
}

function getItems(exampleNr)
{
	var columns = [];

	$(exampleNr + ' ul.sortable-list').each(function(){
		columns.push($(this).sortable('toArray').join(','));				
	});

	return columns.join('|');
}

function printStaff(num,mode) {
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {
			"keytype":"printStaff"
			,"secretcode":num
			,"prtmode":mode
		},
		success: function(data){
			$("#printStaff_td").html(data);
		},
		error: function(e) {
			$("#printStaff_td").html('담당자 불러오기 실패');
		},
		timeout: 3000
	});
}

function callexecbox(enkey,datakey) {
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {
			"secukey":enkey
			,"datakey":datakey
		},
		success: function(data){
			$("#popup_center").html(data);
		},
		error: function(e) {
			alert('[일시적 데이타 통신 실패] 이 메세지가 지속되면 관리자에게 연락바랍니다.');
		},
		timeout: 3000
	});
}

function addStaff(enkey) {
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {
			"keytype":"quickStaffAdd"
			,"enkey":enkey
		},
		success: function(data){
			$("div#quickStaffAdd").html(data);
		},
		error: function(e) {
			alert(msgPrint);
		},
		timeout: 10000
	});
}


/*
	높이 자동 맞춤
*/
function mirEqualHeight(group)
{
	var tallest = 0;
	var thisHeight = 0;
	var tallest_bott = 0;
	var tallest_top = 0;
	group.each(function() {
		var thisBottomHeight = $(this).children("div.bottomTextBox").outerHeight(true);
		var thisTopHeight = $(this).find(".subjectTextBox").outerHeight(true);
//		console.log(thisBottomHeight);
//		console.log(group.attr("class") + "\r\n/tallest : " + tallest + "\r\n/thisHeight : " + thisHeight);
		if(thisBottomHeight > tallest_bott) {
			tallest_bott = thisBottomHeight;
		}

		if(thisTopHeight > tallest_top) {
			tallest_top = thisTopHeight;
		}
	});
	$($(group).selector).children("div.bottomTextBox").css({"height":tallest_bott+"px"});
	$($(group).selector).find(".subjectTextBox").css({"height":tallest_top+"px"});
	group.each(function() {
		var thisHeight = $(this).outerHeight();
//		console.log(thisBottomHeight);
//		console.log(group.attr("class") + "\r\n/tallest : " + tallest + "\r\n/thisHeight : " + thisHeight);
		if(thisHeight > tallest) {
			tallest = thisHeight;
		}
	});
//	console.log("tallest : " + tallest);
	$($(group).selector).css({"height":tallest+"px"});
}

function mirEqualHeightRt(group)
{
	var tallest = 0;
	var thisHeight = 0;
	group.each(function() {
		var thisHeight = $(this).outerHeight(true);
//		console.log(group.attr("class") + "\r\n/tallest : " + tallest + "\r\n/thisHeight : " + thisHeight);
		if(thisHeight > tallest) {
			tallest = thisHeight;
		}
	});
//	console.log("tallest : " + tallest);
	return tallest;
}

function convertHex(hex,opacity){
    hex = hex.replace('#','');
    r = parseInt(hex.substring(0,2), 16);
    g = parseInt(hex.substring(2,4), 16);
    b = parseInt(hex.substring(4,6), 16);
    result = 'rgba('+r+','+g+','+b+','+opacity/100+')';
    return result;
}

function setColorOpacity(colorStr, opacity) {
  if(colorStr.indexOf("rgb(") == 0)
  {
    var rgbaCol = colorStr.replace("rgb(", "rgba(");
    rgbaCol = rgbaCol.replace(")", ", "+opacity+")");
    return rgbaCol;
  }

  if(colorStr.indexOf("rgba(") == 0)
  {
    var rgbaCol = colorStr.substr(0, colorStr.lastIndexOf(",")+1) + opacity + ")";
    return rgbaCol;
  }

  if(colorStr.length == 6)
    colorStr = "#" + colorStr;

  if(colorStr.indexOf("#") == 0)
  {
    var rgbaCol = 'rgba(' + parseInt(colorStr.slice(-6, -4), 16)
        + ',' + parseInt(colorStr.slice(-4, -2), 16)
        + ',' + parseInt(colorStr.slice(-2), 16)
        + ','+opacity+')';
    return rgbaCol;
  }
  return colorStr;
}

function mirclip(text) {
	var copyElement = document.createElement('input');
	copyElement.setAttribute('type', 'text');
	copyElement.setAttribute('value', text);
	copyElement = document.body.appendChild(copyElement);
	copyElement.select();
	
	try {
		document.execCommand('copy');
		alert('클립보드로 복사 되었습니다.');
	} catch (e) {
		copyElement.remove();
		prompt('Ctrl+C 로 아래 텍스트를 복사하십시오.', text);
	} finally {
		if (typeof e == 'undefined') {
		copyElement.remove();
		}
	}
}

function targetSelect(nodename,nodevalue) {
	$("select[name='"+nodename+"'] > option").each(function() {
		if($(this).val()==nodevalue) {
			$(this).prop("selected",true);
		}
	});
}

function mirlocation(addr){
	addr.stopPropagation();
	location.href=addr;
}
function mir_selected(vtype,vname,vvalue) {

	switch (vtype) {
		case "checkbox":
			$("input[name='"+vname+"']").each(function() {
			if($(this).val() == vvalue) {
					$(this).prop("checked",true);
				}
			});
			break;
		case "select":
			$("select[name='"+vname+"'] > option").each(function() {
				if($(this).val() == vvalue) {
					$(this).prop("selected",true);
				}
			});
			break;
		case "radio":
			$("input[name='"+vname+"']").each(function() {
				if($(this).val() == vvalue) {
					$(this).prop("checked",true);
				}
			});
			break;
	}
}

function mir_selected_ex(vtype,vname,vvalue,dfvar,continueuse,continuemsg,continueval,cancelmsg,o5) {
	
	if(vvalue=="") {
		var vvalue = dfvar;
	}

	switch (vtype) {
		case "check":
			if(continueuse=="Y") {

				var ctn = confirm(continuemsg);
				if(ctn == true) {
					
				} else {
					alert(cancelmsg);
					$("input[name='"+vname+"']").each(function() {
					if($(this).val() == continueval) {
							$(this).prop("checked",true);
						}
					});
				}
			}
			break;
		case "select":
			$("select[name='"+vname+"'] > option").each(function() {
				if($(this).val() == vvalue) {
					$(this).prop("selected",true);
				}
			});
			break;
		case "radio":

			$("input[name='"+vname+"']").each(function() {
				if($(this).val() == vvalue) {
					$(this).prop("checked",true);
				}
			});
			break;
	}
}

function mir_request_exec(mode1,mode2,printResult,vnkey,key1,f2,f3){
	var msgPrint = "[mir_request_exec]시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	// 예약변경을 위한 전용값

	$(printResult).html("loading");
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {
			"keytype":mode1
			,"keyObject":printResult
			,"chkkey":key1
			,"secretcode":vnkey
			,"iskey":mode2
		},
		success: function(data){
			$(printResult).html(data);
		},
		error: function(e) {
			$(printResult).html(e);
		}
		,timeout: 10000
	});
}

function doState(inputtype,inputEnkey,printmethod,secretcode,f2,f3,f4,printResult) {
	var msgPrint = "[doState]시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	// 예약변경을 위한 전용값
	var iskey = $("select[name='mir_content[reserve][state]["+printmethod+"]']").val();

	$(printResult).html("loading");
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {
			"keyObject":inputEnkey
			,"keytype":inputtype
			,"iskey":iskey
			,"chkkey":printmethod
			,"secretcode":secretcode
		},
		success: function(data){
			$(printResult).html(data);
		},
		error: function(e) {
			alert(msgPrint);
		}
		,timeout: 10000
	});
}
function doStateAST(inputtype,inputEnkey,printmethod,secretcode,f2,f3,f4,printResult) {
	var msgPrint = "[doStateAST]시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	// 예약변경을 위한 전용값
	var iskey = $("select[name='mir_content[reserve][state]["+printmethod+"]']").val();

	$(printResult).html("<br>데이타를 실시간으로 수집중입니다.<br>수초~수분이 소요될 수 있습니다.");
	$.ajax({
		type:"POST",
		async: true, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: true,
		data: {
			"keyObject":inputEnkey
			,"keytype":inputtype
			,"iskey":iskey
			,"chkkey":printmethod
			,"secretcode":secretcode
		},
		success: function(data){
			$(printResult).html(data);
		},
		error: function(e) {
			alert(msgPrint);
		}
//		,timeout: 30000
	});
}

function printResult(inputmethod,printmethod,fct_keyword,fct_keytype,selectNum,unikey,method1,method2,method3,method4) 
{
	var msgPrint = "[printResult]시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.search.php",
		traditional:true,
		cache: false,
		data: {
			"tObject":unikey
			,"keyword":fct_keyword
			,"keytype":fct_keytype
			,"selectNum":selectNum
			,"passcode":method1
			,"oricode":method2
			,"code3":method3
			,"code4":method4
			},
		success: function(data){
			switch (method1) {
				/*case "cmpopen":
					console.log(data);
					break;*/
				case "code_change_append":
					$("tr.default_msg").remove();
					printmethod.append(data);
					break;
				default :
					printmethod.html(data);
					break;
			}
	},error: function(e) {
		alert(msgPrint);
	},timeout: 5000
	});
}

function printResult2(inputmethod,printmethod,fct_keyword,fct_keytype,selectNum,unikey,method1,method2,method3,method4) 
{
	var msgPrint = "[pr2]시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.search.php",
		traditional:true,
		cache: false,
		data: {
			"tObject":unikey
			,"keyword":fct_keyword
			,"keytype":fct_keytype
			,"selectNum":selectNum
			,"passcode":method1
			,"oricode":method2
			,"code3":method3
			,"code4":method4
			},
		success: function(data){
			switch (method1) {
				/*case "cmpopen":
					console.log(data);
					break;*/
				case "code_change_append":
					printmethod.append(data);
					break;
				default :
					printmethod.html(data);
					break;
			}
	},error: function(e) {
		alert(msgPrint);
	},timeout: 5000
	});
}

function helpinfo(code,f1,f2,f3,f4,f5) {
	alert(code + " 도움말 준비중");
}

function callDynamic(secukey,arr1,arr2,cpinfo,node) {

	var nodeblock = $("#"+node);
	var msgPrint = "[cdy]시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	
	if(nodeblock.children("div").hasClass("tBlack")==true) {
		nodeblock.children("div").html("");
	} else {
		nodeblock.html("");
	}
	nodeblock.removeClass("disNone");
	
	var s_url = atob("L19taXIuZG8uc3FsZXhlYy5waHA=");
	$(".msgsendbox").html("");
	$.ajax({
		type:"POST",
		async: true, 
		url: s_url,
		traditional:true,
		cache: false,
		data: {"secukey":secukey,"secuarr1":arr1,"secuarr2":arr2,"cpinfo":cpinfo,"node":node},
		success: function(data){
			nodeblock.html(data);
		
		},error: function(e) {
			alert(msgPrint);
		},timeout: 10000
	});
}

function mir_calldynamic(databus_tmp) {
	
	var jsonTmp = JSON.parse(databus_tmp);
	var databus = jsonTmp[0];
	var nodeblock = $(databus.node);

	if(databus.msgprt) {
		var msgPrint = databus.msgprt;
	} else {
		var msgPrint = "통신시간을 초과하였거나 시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	}
	
	switch (databus.mode) {
		default :
			if(nodeblock.children("div").hasClass("tBlack")==true) {
				nodeblock.children("div").html("");
			} else {
				nodeblock.html("");
			}
			break;
		case "save_html":
		case "save_append":
			break;
	}
	nodeblock.removeClass("disNone");
	if(databus.msgsndboxdf=="Y") {
		$(".msgsendbox").html("");
	}
	$.ajax({
		type:"POST",
		async: true, 
		url: "/_mir/plugin/_MIR.async.php?key="+databus.urlparam,
		traditional:true,
		cache: false,
		data: {"secukey":databus_tmp},
		success: function(data){
			switch(databus.mode) {
				default:
				case "html":
					nodeblock.html(data);
					break;
				case "append":
				case "save_append":
//					console.log(mode);
					nodeblock.append(data);
					break;
				case "value":
					nodeblock.val(data);
					break;
				case "valueprint":
//					nodeblock.val(data);
					break;
			}
		
		}
		,error: function(e) {
			alert(msgPrint);
		}
		,timeout: databus.timeout
	});

}

function callDynamicEx(secukey,arr1,arr2,cpinfo,node,mode) {

	var nodeblock = $("#"+node);
	var msgPrint = "[cdyex] 네트워크 속도 문제로 시스템에 일시적인 문제가 발생하였습니다. 이 메세지가 지속되면 고객센터에 문의하여 주시기 바랍니다.";
	var s_url = atob("L19taXIuZG8uc3FsZXhlYy5waHA=");

	switch (mode) {
		default :
			if(nodeblock.children("div").hasClass("tBlack")==true) {
				nodeblock.children("div").html("");
			} else {
				nodeblock.html("");
			}
			break;
		case "next_html":
			break;
		case "save_html":
		case "save_append":
			break;
		case "save_append_waypoint":
			$("#smssenderwrap,#smssenderwrapbg,#smssenderScript").remove();
			break;
	}
	nodeblock.removeClass("disNone");

	$(".msgsendbox").html("");
	$.ajax({
		type:"POST",
		async: true, 
		url: s_url,
		traditional:true,
		cache: false,
		data: {"secukey":secukey,"secuarr1":arr1,"secuarr2":arr2,"cpinfo":cpinfo,"node":node},
		success: function(data){

			switch(mode) {
				default:
				case "html":
					nodeblock.html(data);
					break;
				case "html_en":
					nodeblock.html(atob(data));
					break;
				case "html_fadeIn":
					nodeblock.html(data);
					break;
				case "html_safe":
						var data_safe = data;
						//data_safe = data_safereplace(data_safe,"'","\\'");
						//var data_safe = data.replace(/'/gi,"\\\'");
						//var data_safe = data.replace(/'/gi,"\\\'"');
						//nodeblock.html(encodeAll(data_safe));
						nodeblock.html(data_safe);
						break;					
				case "next_html":
					nodeblock.next().html(data);
					break;
				case "append":
				case "save_append":
//					console.log(mode);
					nodeblock.append(data);
					break;
				case "save_append_waypoint":
					nodeblock.append(data);
					break;
				case "value":
					nodeblock.val(data);
					break;
				case "valueprint":
//					nodeblock.val(data);
					break;
			}
			
		}
		,error: function(e) {
			alert(msgPrint);
		}
		,timeout: 10000
	});
}

function mir_callDynamicEx(aryData) 
{
	var node = aryData.node;
	var secukey = aryData.secukey;
	var sType = aryData.sType;
	var mode = aryData.mode;
	var limitout = (typeof aryData.timeout === 'undefined') ? aryData.timeout : 10000;
	var arrset = aryData.arrset;
	var cpinfo = aryData.cpinfo;
	var jarrset = JSON.stringify(arrset);

	var logdata = aryData.logdata;

	var loading_data = aryData.loading_data;

	if(aryData.success_node == true){
		var success_node = $("body");
	}
	
	var nodeblock = $("#"+node);
	var msgPrint = "[cdyex] 네트워크 속도 문제로 시스템에 일시적인 문제가 발생하였습니다. 이 메세지가 지속되면 고객센터에 문의하여 주시기 바랍니다.";
	switch (sType)
	{
		default:
			var s_url = atob("L19taXIuZG8uc3FsZXhlYy5waHA=");
			break;
	}

	switch (mode) {
		default :
			if(nodeblock.children("div").hasClass("tBlack")==true) {
				nodeblock.children("div").html("");
			} else if(mode != "html") {
				nodeblock.html("");
			}
			break;
		case "next_html":
			break;
		case "save_html":
		case "save_append":
		case "text":
			break;
		case "save_append_waypoint":
			$("#smssenderwrap,#smssenderwrapbg,#smssenderScript").remove();
			break;
		case "popup":
			nodeblock = $("body");
			break;
		case "after":
			break;
	}
	nodeblock.removeClass("disNone");
	
	if(loading_data == true){
		$("#"+node).empty();
		nodeblock.append('\
		<style>\
			.lds-ring {\
				display: inline-block;\
				position: relative;\
				width: 80px;\
				height: 80px;\
				left: 50%;\
				margin-left: -40px;\
				top: 50%;\
				margin-top: -40px;\
			}\
			.lds-ring div {\
				box-sizing: border-box;\
				display: block;\
				position: absolute;\
				width: 64px;\
				height: 64px;\
				margin: 8px;\
				border: 8px solid #f15353;\
				border-radius: 50%;\
				animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\
				border-color: #f15353 transparent transparent transparent;\
			}\
			.lds-ring div:nth-child(1) {\
				animation-delay: -0.45s;\
			}\
			.lds-ring div:nth-child(2) {\
				animation-delay: -0.3s;\
			}\
			.lds-ring div:nth-child(3) {\
				animation-delay: -0.15s;\
			}\
			@keyframes lds-ring {\
				0% {\
				transform: rotate(0deg);\
				}\
				100% {\
				transform: rotate(360deg);\
				}\
			}</style>\
		<div class="lds-ring"><div></div><div></div><div></div><div></div></div>\
		');
	}
	$(".msgsendbox").html("");
	$.ajax({
		type:"POST",
		async: true, 
		url: s_url,
		traditional:true,
		cache: false,
		data: {
			"secukey":secukey,"secuarrset":jarrset,"cpinfo":cpinfo,"node":node
		},
		success: function(data){
			if(loading_data == true){
				$("#"+node).empty();
			}
			switch(mode) {
				default:
				case "html":
					nodeblock.html(data);
					break;
				case "html_en":
					nodeblock.html(atob(data));
					break;
				case "html_fadeIn":
					nodeblock.html(data);
					break;
				case "html_safe":
						var data_safe = data;
						//data_safe = data_safereplace(data_safe,"'","\\'");
						//var data_safe = data.replace(/'/gi,"\\\'");
						//var data_safe = data.replace(/'/gi,"\\\'"');
						//nodeblock.html(encodeAll(data_safe));
						nodeblock.html(data_safe);
						break;					
				case "next_html":
					nodeblock.next().html(data);
					break;
				case "append":
				case "save_append":
//					console.log(mode);
					if(data == 'assist_worker_overlap'){
						alert("이미 추가된 작업자입니다.");
					} else {
						nodeblock.append(data);
					}
					break;
				case "save_append_waypoint":
					nodeblock.append(data);
					break;
				case "value":
					nodeblock.val(data);
					break;
				case "valueprint":
					if(success_node && data != "different_worker"){

						success_node.append("<div id=\"change_save_alert\"><p>변경사항이 저장되었습니다.</p></div>");
						setTimeout(function(){
							$("#change_save_alert").remove();
						}, 3000);
					}

					if(data == "different_worker"){
						alert("본인의 작업만 수정할 수 있습니다.");
					}
					console.log(data);
//					nodeblock.val(data);
					break;
				case "popup":
					nodeblock.append(data);
					break;
				case "after":
					nodeblock.after(data);
					break;
				case "text":
					if(data == 'different_worker'){
						alert("본인의 작업만 수정할 수 있습니다.");
					} else {
						nodeblock.text(data);
					}
					break;
			}

			if(logdata != undefined && data!='different_worker') {
				mir_callDynamicEx({'secukey':logdata.log_secukey, 'mode':'html', 'node': 'log_wrap_' + logdata.log_idx, 'arrset':{'secuarr1': logdata.log_arr} });
			}
		}
		,error: function(e) {
			//callDynamicEx();
			alert(msgPrint);
		}
		,timeout: limitout
	});

}


function mir_assist_callDynamicEx(aryData) 
{
	var node = aryData.node;
	var secukey = aryData.secukey;
	var sType = aryData.sType;
	var mode = aryData.mode;
	var limitout = (typeof aryData.timeout === 'undefined') ? aryData.timeout : 10000;
	var arrset = aryData.arrset;
	var cpinfo = aryData.cpinfo;
	var jarrset = JSON.stringify(arrset);

	var logdata = aryData.logdata;

	var loading_data = aryData.loading_data;

	if(aryData.success_node == true){
		var success_node = $("body");
	}

	var nodeblock = $("#"+node);
	var msgPrint = "[cdyex] 네트워크 속도 문제로 시스템에 일시적인 문제가 발생하였습니다. 이 메세지가 지속되면 고객센터에 문의하여 주시기 바랍니다.";
	switch (sType)
	{
		default:
			var s_url = atob("L19taXIvcGx1Z2luL2Fzc2lzdC5hamF4LmNvcmUucGhw");
			break;
	}

	switch (mode) {
		default :
			if(nodeblock.children("div").hasClass("tBlack")==true) {
				nodeblock.children("div").html("");
			} else if(mode != "html") {
				nodeblock.html("");
			}
			break;
		case "next_html":
			break;
		case "save_html":
		case "save_append":
		case "text":
			break;
		case "save_append_waypoint":
			$("#smssenderwrap,#smssenderwrapbg,#smssenderScript").remove();
			break;
		case "popup":
			nodeblock = $("body");
			break;
		case "after":
			break;
	}
	nodeblock.removeClass("disNone");
	
	if(loading_data == true){
		$("#"+node).empty();
		nodeblock.append('\
		<style>\
			.lds-ring {\
				display: inline-block;\
				position: relative;\
				width: 80px;\
				height: 80px;\
				left: 50%;\
				margin-left: -40px;\
				top: 50%;\
				margin-top: -40px;\
			}\
			.lds-ring div {\
				box-sizing: border-box;\
				display: block;\
				position: absolute;\
				width: 64px;\
				height: 64px;\
				margin: 8px;\
				border: 8px solid #f15353;\
				border-radius: 50%;\
				animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\
				border-color: #f15353 transparent transparent transparent;\
			}\
			.lds-ring div:nth-child(1) {\
				animation-delay: -0.45s;\
			}\
			.lds-ring div:nth-child(2) {\
				animation-delay: -0.3s;\
			}\
			.lds-ring div:nth-child(3) {\
				animation-delay: -0.15s;\
			}\
			@keyframes lds-ring {\
				0% {\
				transform: rotate(0deg);\
				}\
				100% {\
				transform: rotate(360deg);\
				}\
			}</style>\
		<div class="lds-ring"><div></div><div></div><div></div><div></div></div>\
		');
	}
	$(".msgsendbox").html("");
	$.ajax({
		type:"POST",
		async: true, 
		url: s_url,
		traditional:true,
		cache: false,
		data: {
			"secukey":secukey,"secuarrset":jarrset,"cpinfo":cpinfo,"node":node
		},
		success: function(data){
			if(loading_data == true){
				$("#"+node).empty();
			}
			switch(mode) {
				default:
				case "html":
					nodeblock.html(data);
					break;
				case "append":
				case "save_append":
					if(data == 'assist_worker_overlap'){
						alert("이미 추가된 작업자입니다.");
					} else {
						nodeblock.append(data);
					}
					break;
				case "value":
					nodeblock.val(data);
					break;
				case "valueprint":
					if(success_node && data != "different_worker"){

						success_node.append("<div id=\"change_save_alert\"><p>변경사항이 저장되었습니다.</p></div>");
						setTimeout(function(){
							$("#change_save_alert").remove();
						}, 3000);
					}

					if(data == "different_worker"){
						alert("본인의 작업만 수정할 수 있습니다.");
					}
					console.log(data);
//					nodeblock.val(data);
					break;
				case "popup":
					nodeblock.append(data);
					break;
				case "after":
					nodeblock.after(data);
					break;
				case "text":
					if(data == 'different_worker'){
						alert("본인의 작업만 수정할 수 있습니다.");
					} else {
						nodeblock.text(data);
					}
					break;
			}

			if(logdata != undefined && data!='different_worker') {
				mir_callDynamicEx({'secukey':logdata.log_secukey, 'mode':'html', 'node': 'log_wrap_' + logdata.log_idx, 'arrset':{'secuarr1': logdata.log_arr} });
			}
		}
		,error: function(e) {
			alert(msgPrint);
		}
		,timeout: limitout
	});

}

function sms_loader(num,node,farr1,farr2,farr3) {

	var nodeblock = $("#"+node);
	var msgPrint = "[sld]시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	
	nodeblock.removeClass("disNone").addClass("disBlock");

	$(".msgsendbox").html("");
	$.ajax({
		type:"POST",
		async: true, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {"sndnum":num, "secukey":farr1,"secuarr1":farr2,"cpinfo":farr3},
		success: function(data){
			nodeblock.html(data);
		
		},error: function(e) {
			alert(msgPrint);
		},timeout: 10000
	});

}

function addCommas(nStr)
{
    nStr += '';
    x = nStr.split('.');
    x1 = x[0];
    x2 = x.length > 1 ? '.' + x[1] : '';
    var rgx = /(\d+)(\d{3})/;
    while (rgx.test(x1)) {
        x1 = x1.replace(rgx, '$1' + ',' + '$2');
    }
    return x1 + x2;
}

function payhistory(dataresult,node) {

	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {"temper":dataresult,"keytype":"payhistory"},
		success: function(data){
			$("#"+node).show();
			$("#"+node).html(data);
		},error: function(e) {
			alert(msgPrint);
		},timeout: 10000
	});
}

function result_call(num,node,farr1,farr2,farr3) {
	var nodeblock = $("#"+node);
	var msgPrint = "[rc]시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	
	nodeblock.removeClass("disNone").addClass("disBlock");
	
	if(num=="cancel") {
		var cancelmsg = confirm("취소하시겠습니까? 취소 후 복구는 불가합니다.");
		if(cancelmsg==false) {
			return false;
		}
	}

	$(".msgsendbox").html("");
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {"sndnum":num, "secukey":farr1,"secuarr2":farr2,"secuarr3":farr3},
		success: function(data){
			nodeblock.html(data);
			
		},error: function(e) {
			alert(msgPrint);
		},timeout: 10000
	});

}

function mirVisiting(secukey,secuarr,mirvc) {
	$.ajax({
		type:"POST",
		async: true, 
		url: "/_mir/visit.insert.php",
		traditional:true,
		cache: false,
		data: {"secucode":secukey,"secuarr":secuarr,"mirvc":mirvc},
		success: function(data){
			console.log("vilog:"+data);
		}
		,error: function(e) {
			//console.log("vilog_f:"+data);
			//alert(msgPrint);
		}
		//,timeout: 5000
	});
}

function mbid_chk(v) {
	var msgPrint = "[midc]시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	var valmbid = v.value;
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {"reg_mb_id":valmbid, "keytype":"id_validate"},
		success: function(data){
			if(data=="") {
				$("span#msg_mb_id").html("아이디를 입력해주세요.");
				$("input[name='mb_id']").addClass("attentionBorder2px");
				$("input[name='mb_id_state']").val("N");

			} else {
				switch (data) {
					default :
						$("span#msg_mb_id").html(data);
						$("input[name='mb_id']").addClass("attentionBorder2px");
						$("input[name='mb_id_state']").val("N");
						break;
					case "noenter":
						$("span#msg_mb_id").html("아이디를 입력해주세요.");
						$("input[name='mb_id']").addClass("attentionBorder2px");
						$("input[name='mb_id_state']").val("N");
						break;
					case "deny":
						$("span#msg_mb_id").html("이미 사용중인 아이디입니다.");
						$("input[name='mb_id']").addClass("attentionBorder2px");
						$("input[name='mb_id_state']").val("N");
						break;
					case "allow":
						$("span#msg_mb_id").html("사용가능한 아이디입니다.");
						$("input[name='mb_id']").removeClass("attentionBorder2px");
						$("input[name='mb_id_state']").val("Y");
						break;
				}
			}
	},error: function(e) {
		alert(msgPrint);
	},timeout: 10000
	});
}


function mbnick_chk(v) {
	var msgPrint = "시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	var valmbid = v.value;
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {"reg_mb_nick":valmbid, "keytype":"nick_validate"},
		success: function(data){

			if(data=="") {
				$("span#msg_mb_nick").html("닉네임을 입력해주세요.");
				$("input[name='mb_nick']").addClass("attentionBorder2px");
				$("input[name='mb_nick_state']").val("N");
			} else {
				switch (data) {
					case "nick_chk_trim":
						$("span#msg_mb_nick").html("닉네임은 공백없이 한글, 영문, 숫자만 입력 가능합니다.");
						$("input[name='mb_nick']").addClass("attentionBorder2px");
						$("input[name='mb_nick_state']").val("N");
						break;
					case "nick_chk_trim2":
						$("span#msg_mb_nick").html("닉네임은 한글 2글자, 영문 4글자 이상 입력 가능합니다.");
						$("input[name='mb_nick']").addClass("attentionBorder2px");
						$("input[name='mb_nick_state']").val("N");
						break;
					case "allow":
						$("span#msg_mb_nick").html(valmbid + " 이 닉네임은 사용가능합니다.");
						$("input[name='mb_nick']").removeClass("attentionBorder2px");
						$("input[name='mb_nick_state']").val("Y");
						break;
					case "deny_use":
						$("span#msg_mb_nick").html("현재 등록된 닉네임과 동일합니다.");
						$("input[name='mb_nick']").removeClass("attentionBorder2px");
						$("input[name='mb_nick_state']").val("Y");
						break;
					case "deny":
						$("span#msg_mb_nick").html("이 닉네임은 이미 사용중입니다.");
				$("input[name='mb_nick']").addClass("attentionBorder2px");
						$("input[name='mb_nick_state']").val("N");
						break;
				}
			}

	},error: function(e) {
		alert(msgPrint);
	},timeout: 10000
	});
}

function mir_reg_mb_email_check() {
	var result = "";
	var valmbid = ($("#reg_mb_email").val());
	$.ajax({
		type: "POST",
		url: "/_mir.do.sqlexec.php",
		data: {
			"reg_mb_email": valmbid,
			"keytype":"email_validate_sp"
		},
		cache: false,
		async: false,
		success: function(data) {
			result = data;
		}
	});
	return result;
}

function mbemail_chk(v) {
	var msgPrint = "시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	var valmbid = v.value;
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {"reg_mb_email":valmbid, "keytype":"email_validate"},
		success: function(data){

			if(data=="") {
				$("span#msg_mb_email").html("이메일을 입력해주세요.");
				$("input[name='mb_email']").addClass("attentionBorder2px");
				$("input[name='mb_email_state']").val("N");
			} else {
				switch (data) {
					case "allow":
						$("span#msg_mb_email").html(valmbid + " 이 이메일은 가능합니다.");
						$("input[name='mb_email']").removeClass("attentionBorder2px");
						$("input[name='mb_email_state']").val("Y");
						break;
					case "deny_use":
						$("span#msg_mb_email").html("현재 등록된 이메일과 동일합니다.");
						$("input[name='mb_email']").removeClass("attentionBorder2px");
						$("input[name='mb_email_state']").val("Y");
						break;
					case "deny":
						$("span#msg_mb_email").html("이 이메일은 이미 사용중입니다.");
						$("input[name='mb_email']").addClass("attentionBorder2px");
						$("input[name='mb_email_state']").val("N");
						break;
					case "notemail":
						$("span#msg_mb_email").html("이 이메일 형식이 올바르지 않습니다.");
						$("input[name='mb_email']").addClass("attentionBorder2px");
						$("input[name='mb_email_state']").val("N");
						break;
				}
			}

	},error: function(e) {
		alert(msgPrint);
	},timeout: 10000
	});
}

function mir_reg_mb_hp_check() {
	var result = "";
	var valmbhp = ($("#reg_mb_hp").val());
	$.ajax({
		type: "POST",
		url: "/_mir.do.sqlexec.php",
		data: {
			"reg_mb_hp": valmbhp,
			"keytype":"hp_validate_sp"
		},
		cache: false,
		async: false,
		success: function(data) {
			result = data;
		}
	});
	return result;
}

function mbhp_chk(v) {
	var msgPrint = "시스템에 일시적인 문제가 발생하였습니다. 고객센터에 문의하여 주시기 바랍니다.";
	var valmbid = v.value;
	$.ajax({
		type:"POST",
		async: false, 
		url: "/_mir.do.sqlexec.php",
		traditional:true,
		cache: false,
		data: {"reg_mb_hp":valmbid, "keytype":"hp_validate"},
		success: function(data){
			if(data=="") {
				$("span#msg_mb_hp").html("");
				$("input[name='mb_hp']").removeClass("attentionBorder2px");
				$("input[name='mb_hp_state']").val("Y");
			}
			else {
				switch (data) {
					case "allow":
						$("span#msg_mb_hp").html(valmbid + " 이 번호는 사용이 가능합니다.");
						$("input[name='mb_hp']").removeClass("attentionBorder2px");
						$("input[name='mb_hp_state']").val("Y");
						break;
					case "deny":
						$("span#msg_mb_hp").html("이미 사용중인 번호입니다.");
						$("input[name='mb_hp']").addClass("attentionBorder2px");
						$("input[name='mb_hp_state']").val("N");
						break;
					case "deny_use":
						$("span#msg_mb_hp").html("현재 번호와 동일합니다.");
						$("input[name='mb_hp']").removeClass("attentionBorder2px");
						$("input[name='mb_hp_state']").val("Y");
						break;
				}
			}

	},error: function(e) {
		alert(msgPrint);
	},timeout: 10000
	});
}

function checkNumInput(ft,sn,en) {
	var ftval = ft.value;
	if(ftval < sn) {
		ft.value = sn;
		alert(sn + "부터" + en + "까지 입력 가능");
	} else if(ftval > en) {
		ft.value = en;
		alert(sn + "부터" + en + "까지 입력 가능");
	} else {
		
	}
}

function enable_admPanel(uid) {
//	e.preventDefault();
	$('li.'+uid).find('ul.mir_admpanel').css({'display':'block'});
}
function disable_admPanel(uid) {
//	e.preventDefault();
	$('li.'+uid).find('ul.mir_admpanel').css({'display':'none'});
}

function isCellPhone(p) {
	p = p.split('-').join('');
	var regPhone = /^((01[1|6|7|8|9])[1-9]+[0-9]{6,7})|(010[1-9][0-9]{7})$/;
	return regPhone.test(p);
}

$(document).on("mouseover",".setLine_s",function() {
	$(this).addClass("df_line_s");
});
$(document).on("mouseleave",".setLine_s",function() {
	$(this).removeClass("df_line_s");
});

$(document).on("keyup",".reTyping",function() {

	if($(this).val().length > 0) {
		
		$(this).removeClass("bgMint");
	} else if($(this).val().length == 0) {

		$(this).addClass("bgMint");
	}
});
$(document).on("keyup",".onlynumber",function() {
	
	if($(this).val().length > 11) {
		alert('번호 길이를 확인해주세요. 한국 핸드폰번호는 최대 11자리입니다.');
		$(this).val($(this).val().substring(0,11));
	}
	$(this).val($(this).val().replace(/[^0-9]/g,""));

});
$(document).on("keyup",".onlyage",function() {
	
	if($(this).val().length > 2) {
		if($(this).val()!=100) {
			alert('99세 이상은 100세로 표기합니다.');
			$(this).val(100);
		}
	}
	$(this).val($(this).val().replace(/[^0-9]/g,""));

});
$(document).on("keyup",".spacetocomma",function() {
	
//	$(this).val($(this).val().replace(/[^ ]/g,","));
	$(this).val($(this).val().replace(" ",","));
});

function retryForm(f) {
	var tmp = $('form#'+f).serialize();
	return tmp;
}

function MirformAjax(fName,secukey,exeKey) {

	var queryString = $("form#form_"+fName).serialize();
	var fNameNum = fName.replace("submit_","");

	if($("form#form_"+fName+" input[name='mir_content[requestset][requiredaccept][privicy]").is(":checked")!=true) {

		$("label.policy_"+fNameNum).addClass("bgAttention");
		alert("개인정보취급방침에 동의하셔야 합니다!");
		return false;
	}

	$("form#form_"+fName+" .required").each(function() {
		
		var thistitle = $(this).attr("title");
		var thisname = $(this).attr("name");
		if($(this).val()=="") {
			$(this).focus();
			$(this).addClass("bgMint reTyping");
			alert(thistitle + "은 필수입력값 입니다");
			returnNow = true;
			return false;
		} else {
			if(thisname == "wr_1") {
				
				if($(this).val().length >= 10 && $(this).val().length <= 11) {

				} else {
					$(this).focus();
					$(this).addClass("bgMint reTyping");
					alert(thistitle + "의 입력길이가 올바르지 않습니다.");
					returnNow = true;
					return false;
				}
			} 
			returnNow = false;
		}
	});
//console.log(returnNow);
	if(returnNow == true) {
		return;
	}

	$.ajax({
		type : 'post'
		,url : '/_mir.do.sqlexec.php'
		,data: {
			"secukey":secukey
			,"secuStringArr":queryString
			,"exeKey":exeKey
		}
//		,dataType : 'json'
		,error: function(xhr, status, error) {
			$("div.prt_"+fName).html('데이타통신에 실패하였습니다'+status);
		}
		,success : function(dataResult) {
			var thisNode = $("div.prt_"+fName);

			switch(dataResult) {
				default:
					thisNode.html(dataResult);
					var thisNodeHeight = thisNode.outerHeight(true);
					thisNode.css({"height":thisNodeHeight+"px"});
					$("form#form_"+fName)[0].reset();
					break;
				case "no_privicy":
					alert("개인정보취급방침에 동의하셔야 합니다");
					$("label.policy_"+fNameNum).addClass("bgAttention");
					return false;
					break;
			}
		}
	});

}

$(document).ready(function() {

	$(".qimg_li").hover(function() {
		$(this).children(".qimg_setup").show();
	},
	function() {
		$(this).children(".qimg_setup").hide();
	});

	$("svg").mouseenter(function(){
		$(this).find("*.hover").each(function(){
			var thisConfirmHoverFill = $(this).attr('hoverfill');
			var thisConfirmHoverStroke = $(this).attr('hoverstroke');
			if(thisConfirmHoverFill != '')
			{
				$(this).css({'fill':thisConfirmHoverFill});
			}
			if(thisConfirmHoverStroke != '')
			{
				$(this).css({'stroke':thisConfirmHoverStroke});
			}
			
			
		});
	});
	
	$("svg").mouseleave(function(){
		$(this).find("*.hover").each(function(){
			var thisConfirmSaveFill = $(this).attr('savefill');
			var thisConfirmSaveStroke = $(this).attr('savestroke');
			if(thisConfirmSaveFill != '')
			{
				$(this).css({'fill':thisConfirmSaveFill});
			}
			if(thisConfirmSaveStroke != '')
			{
				$(this).css({'stroke':thisConfirmSaveStroke});
			}
		});
	});

	$(".mir_button").mouseover(function(){
		var thishoverbgcolor = $(this).attr("hover-background-color");
		var thishovercolor = $(this).attr("hover-color");
		var thishoverBoxShadow = $(this).attr("hover-box-shadow");
		var thishoverOpacity = $(this).attr("hover-opacity");
		var thishoverBorderTop = $(this).attr("hover-border-top");
		var thishoverBorderBottom = $(this).attr("hover-border-bottom");
		var thishoverBorderLeft = $(this).attr("hover-border-left");
		var thishoverBorderRight = $(this).attr("hover-border-right");

		if(thishoverbgcolor != "")
		{
			$(this).css({"background-color":thishoverbgcolor});
		}
		if(thishovercolor != "")
		{
			$(this).css({"color":thishovercolor});
		}
		if(thishoverBoxShadow != "")
		{
			$(this).css({"box-shadow":thishoverBoxShadow});
		}
		if(thishoverOpacity != "")
		{
			$(this).css({"opacity":thishoverOpacity});
		}
		if(thishoverBorderTop != "")
		{
			$(this).css({"border-top":thishoverBorderTop});
		}
		if(thishoverBorderBottom != "")
		{
			$(this).css({"border-bottom":thishoverBorderBottom});
		}
		if(thishoverBorderLeft != "")
		{
			$(this).css({"border-left":thishoverBorderLeft});
		}
		if(thishoverBorderRight != "")
		{
			$(this).css({"border-right":thishoverBorderRight});
		}
		$(this).find("svg *.hover").each(function(){
			var thisConfirmHoverFill = $(this).attr("hoverfill");
			var thisConfirmHoverStroke = $(this).attr("hoverstroke");
			if(thisConfirmHoverFill != "")
			{
				$(this).css({"fill":thisConfirmHoverFill});
			}
			if(thisConfirmHoverStroke != "")
			{
				$(this).css({"stroke":thisConfirmHoverStroke});
			}
		});
	});

	$(".mir_button").mouseout(function(){
		var thisbgcolor = $(this).attr("background-color");
		var thiscolor = $(this).attr("color");
		var thisBoxShadow = $(this).attr("box-shadow");
		var thisOpacity = $(this).attr("opacity");
		var thisBorderTop = $(this).attr("border-top");
		var thisBorderBottom = $(this).attr("border-bottom");
		var thisBorderLeft = $(this).attr("border-left");
		var thisBorderRight = $(this).attr("border-right");
		if(thisbgcolor != "")
		{
			$(this).css({"background-color":thisbgcolor});
		}
		if(thiscolor != "")
		{
			$(this).css({"color":thiscolor});
		}
		if(thisBoxShadow != "")
		{
			$(this).css({"box-shadow":thisBoxShadow});
		}
		if(thisOpacity != "")
		{
			$(this).css({"opacity":thisOpacity});
		}
		if(thisBorderTop != "")
		{
			$(this).css({"border-top":thisBorderTop});
		}
		if(thisBorderBottom != "")
		{
			$(this).css({"border-bottom":thisBorderBottom});
		}
		if(thisBorderLeft != "")
		{
			$(this).css({"border-left":thisBorderLeft});
		}
		if(thisBorderRight != "")
		{
			$(this).css({"border-right":thisBorderRight});
		}
		$(this).find("svg *.hover").each(function(){
			var thisConfirmSaveFill = $(this).attr("savefill");
			var thisConfirmSaveStroke = $(this).attr("savestroke");
			if(thisConfirmSaveFill != "")
			{
				$(this).css({"fill":thisConfirmSaveFill});
			}
			if(thisConfirmSaveStroke != "")
			{
				$(this).css({"stroke":thisConfirmSaveStroke});
			}
		});
	});

	$('.anirubberBandOver').on('mouseover',function(){
		$('.anirubberBandOver').stop().css({'animation-play-state':'running','animation-name':'none'});
		$(this)
			.stop()
			.css({'animation-play-state':'running'
					,'animation-duration':'1s'
					,'animation-name':'rubberBand'
					,'animation-iteration-count':'infinite'
				});
	});
	$('.anirubberBandClick').on('click',function(){
		$('.anirubberBandClick').stop().css({'animation-play-state':'running','animation-name':'none'});
		$(this)
			.stop()
			.css({'animation-play-state':'running'
					,'animation-duration':'1s'
					,'animation-name':'rubberBand'
					,'animation-iteration-count':'infinite'
				});
	});
	$('.anirubberBandOver,.anibounceOver,.aniShakeOver,.aniPulseOver,.aniHeartBeatOver').on('mouseout',function(){
		$(this)
			.stop()
			.css({'animation-iteration-count':'1','animation-name':'none'});
	})
	
	$('.anibounceOver').on('mouseover',function(){
		$('.anibounceOver').stop().css({'animation-play-state':'running','animation-name':'none'});
		$(this).stop()
		.css({'animation-play-state':'running'
			,'animation-duration':'1s'
			,'animation-name':'bounce'
			,'animation-iteration-count':'infinite'
		});
	});
	$('.aniShakeOver').on('mouseover',function(){
		$('.aniShakeOver').stop().css({'animation-play-state':'running','animation-name':'none'});
		$(this).stop()
		.css({'animation-play-state':'running'
			,'animation-duration':'0.5s'
			,'animation-name':'shake'
			,'animation-iteration-count':'infinite'
		});
	});
	$('.aniHeartBeatOver').on('mouseover',function(){
		$('.aniHeartBeatOver').stop().css({'animation-play-state':'running','animation-name':'none'});
		$(this).stop()
		.css({'animation-play-state':'running'
			,'animation-duration':'1s'
			,'animation-name':'heartBeat'
			,'animation-iteration-count':'infinite'
		});
	});

	$('.anibounce1t_click').on('click',function(){
		$('.anibounce1t_click').stop().css({'animation-play-state':'running','animation-name':'none'});
		$(this).stop().css({'animation-play-state':'running','animation-duration':'1s','animation-name':'bounce','animation-iteration-count':'1'});
	});

	$(document).on("click",".admpn_modify",function(e) {
		e.stopPropagation();
		var addr = $(this).attr("rel");
		location.href=addr;
	});

	$(".admpn_close").on("click",function(e) {
		e.stopPropagation();
		$(this).parents().eq(2).addClass("disNone");
	});


	$( ".mirpick_datepicker" ).datepicker({
		changeMonth: true,
		changeYear: true
	});
	  
	$(".mir_admpanel_move").draggable({
		cursor: "move"
	});

	$(".dfLabel input.typeLabel").on("change",function() {
		var thisNum = $(this).attr("id");

		$("label#"+thisNum).removeClass("labelhover");
		if($("label#"+thisNum).hasClass("labelhover")==false) {
			$("label#"+thisNum).addClass("labelhover");
		} else {
		$("label#"+thisNum).removeClass("labelhover");
		}
	});
	
	$(document).on("keyup","input[type=number].underone",function() {
		if($(this).val()<0 && $(this).val()<=1) {
			alert("입력값은 0보다 크거나 같아야합니다. 입력값을 확인해주세요.");
			$(this).val("0").focus();
			return;
		} else if($(this).val()>0 && $(this).val()>=1) {
			alert("입력값은 1보다 작거나 같아야합니다. 입력값을 확인해주세요.");
			$(this).val("1").focus();
			return;
		}
	});

	$(document).on("keyup","input[type=number].minzero,input[type=number].nozero",function() {
		if($(this).val()<0) {
			alert("입력값은 0보다 커야합니다. 입력값을 확인해주세요.");
			$(this).val("0").focus();
			return;
		}
	});

	$(document).on("keyup","input[type=number].dfone",function() {
		if($(this).val()<1) {
			alert("입력값은 1보다 같거나 커야합니다. 입력값을 확인해주세요.");
			$(this).val("1").focus();
			return;
		}
	});
	$(document).on("keyup","input[type=number].max100",function() {
		if($(this).val()>100) {
			alert("입력값은 100보다 작아야합니다. 입력값을 확인해주세요.");
			$(this).val("100").focus();
			return;
		}
	});

	$("#mir_quickmenu > ul > li").not(".notatall").on("mouseover",function() {
		$(this).children("div").removeClass("disNone");
	});

	$("#mir_quickmenu > ul > li").not(".notatall").on("mouseleave",function() {
		$(this).children("div").addClass("disNone");
	});

	
	$("#msgBoxTopWrap").on("click",function() {
		if($("#msgBoxTop").hasClass('disNone')==true) {
			$("#msgBoxTop").removeClass('disNone');
		} else {
			$("#msgBoxTop").addClass('disNone');
		}
	});
	$(document).on("click","#msgBoxTopClose",function() {
		$("#popup_center").html('');
		$("#msgBoxTop").addClass('disNone');
	});
	$(".msgBox_memoTopClose").on("click",function() {
		alert(1);
	});

	/*
		ie 9 under placeholer support
	*/
	/*
	if ((document.all && !document.querySelector) || (document.all && document.querySelector && !document.addEventListener) ) {

		if (!("placeholder" in document.createElement("input"))) { 
			jQuery(":input[placeholder]").each(function () {
				var $this = jQuery(this);
				var pos = $this.offset();
				if (!this.id) this.id = "jQueryVirtual_" + this.name;
				if (this.id) {
					if (jQuery.browser.version  < 8) {
						$this.after("<label for='" + this.id + 
							"' id='jQueryVirtual_label_" + this.id + 
							"' class='absolute'>" + $this.attr("placeholder") + 
							"</label>");
						$("#jQueryVirtual_label_" + this.id).
							css({"left":(pos.left+5), "margin-top":3, 
							"width":$this.width()});
					}
					else {
						$this.after("<label for='" + this.id + 
						"' id='jQueryVirtual_label_" + this.id + 
						"' style='left:" + (pos.left+5) + 
						"px;margin-top:2px' class='absolute'>" + 
						$this.attr("placeholder") + "</label>");
					}
				}
			}).focus(function () {
				var $this = jQuery(this);
				$this.addClass("focusbox");
				jQuery("#jQueryVirtual_label_" + $this.attr("id")).hide();
			}).blur(function () {
				var $this = jQuery(this);
				$this.removeClass("focusbox");
				if(!jQuery.trim($this.val())) 
					jQuery("#jQueryVirtual_label_" + $this.attr("id")).show();
				else jQuery("#jQueryVirtual_label_" + $this.attr("id")).hide();
			}).trigger("blur");
		}
	}
	*/
		
	$("body script.tgDel").remove();
});

function do_msgBox(md,stk,doexec,doarr,uno,uid) {

	$.ajax({
		type:"POST"
		,async: true
		,url: "/_mir.do.sqlexec.php"
		,traditional:true
		,cache: false
		,dataType:'json'
		,data: {
			"secukey":md
			,"keyObject":stk
			,"secretcode":doexec
			,"chkkey":doarr
			,"iskey":uno
			,"iskey2":uid
		}
		,success: function(data){
			$("#popup_center").html(data.tpBackground);
			$("#msgBoxTop").html(data.defaulthtml);
			$(".msgBoxContent").html(data.msgContent);
			if(data.prtmemo) {
			$("#ol_after_memo").append(data.msgView);
			}
			$(".msgBoxContentFoot").html(data.msgContentFoot);
			$(".msgBoxContent_debug").html(data.debug);
			$(".msgCnt").html(data.msgCnt);
		}
		,error: function(data) {
			$(".msgBoxContent_debug").html('Error : '+data.debug);
		}
		,timeout: 10000
	});
}

function exeSort(key,doNum) {
	$.ajax({
		type:"POST"
		,async: true
		,url: "/_mir.do.sqlexec.php"
		,traditional:true
		,cache: false
		,data: {
			"secukey":key
			,"getdata":doNum
		}
		,success: function(data){
			$("#popup_center").html(data);
		}
		,error: function(data) {
//			$(".msgBoxContent_debug").html('Error : '+data.debug);
		}
		,timeout: 10000
	});
}

function doSortable(doType,doNum,act,key) {

	switch (doType) {
		case "sortexec":
			$(document).ready(function(){
				$("#sortWrap"+doNum+" .sortable-list").disableSelection().sortable({
					opacity:0.4
					,placeholder: "placeholder"
					,connectWith:"#sortWrap"+doNum+" .sortable-list"
				});

				$(".sort_open"+doNum+"").click(function() {
					$(".sortContainerAll").hide();
					$("#sortContainer"+doNum+"").show();
				});

				$(".sort_close"+doNum+"").click(function() {
					$("#sortContainer"+doNum+"").hide();
				});

				$(".btn_save"+doNum+"").click(function(){
					getSortExec(""+doNum+"",""+act+"",""+key+"");
				});
			});
			break;
		case "sortAppend":
			$(document).ready(function(){
				$("#sortWrap_"+doNum+" .sortable-list").append(""+act+"");
			});
			break;
	}
}

/* 숫자만 입력받기 */
function fn_press(event, type) {
	if(type == "numbers") {
		if(event.keyCode < 48 || event.keyCode > 57) {
			return false;
		}
		else {
			
		}
		//onKeyDown일 경우 좌, 우, tab, backspace, delete키 허용 정의 필요
	}
}
/* 한글입력 방지 */
function fn_press_han(obj)
{
	//좌우 방향키, 백스페이스, 딜리트, 탭키에 대한 예외
	if(event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 37 || event.keyCode == 39
	|| event.keyCode == 46 ) return;
	//obj.value = obj.value.replace(/[\a-zㄱ-ㅎㅏ-ㅣ가-힣]/g, '');
	obj.value = obj.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g, '');
}

/*
	
*/
var mir_zip = function(frm_name, frm_zip, frm_addr1, frm_addr2, frm_addr3, frm_jibeon) {
    if(typeof daum === 'undefined'){
        alert("다음 우편번호 postcode.v2.js 파일이 로드되지 않았습니다.");
        return false;
    }

    var zip_case = 1;   //0이면 레이어, 1이면 페이지에 끼워 넣기, 2이면 새창

    var complete_fn = function(data){
        // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

        // 각 주소의 노출 규칙에 따라 주소를 조합한다.
        // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
        var fullAddr = ''; // 최종 주소 변수
        var extraAddr = ''; // 조합형 주소 변수

        // 사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
        if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
			
			if(data.userLanguageType == 'K') {
			fullAddr = data.roadAddress;
			}
			else if(data.userLanguageType == 'E') {
			fullAddr = data.roadAddressEnglish;
			}

        } else { // 사용자가 지번 주소를 선택했을 경우(J)
            fullAddr = data.jibunAddress;
        }

        // 사용자가 선택한 주소가 도로명 타입일때 조합한다.
        if(data.userSelectedType === 'R'){
            //법정동명이 있을 경우 추가한다.
            if(data.bname !== ''){
                extraAddr += data.bname;
            }
            // 건물명이 있을 경우 추가한다.
            if(data.buildingName !== ''){
                extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
            }
            // 조합형주소의 유무에 따라 양쪽에 괄호를 추가하여 최종 주소를 만든다.
            extraAddr = (extraAddr !== '' ? ' ('+ extraAddr +')' : '');
        }

        // 우편번호와 주소 정보를 해당 필드에 넣고, 커서를 상세주소 필드로 이동한다.
        var of = document[frm_name];

        of[frm_zip].value = data.zonecode;

        of[frm_addr1].value = fullAddr;
        of[frm_addr3].value = extraAddr;

        if(of[frm_jibeon] !== undefined){
            of[frm_jibeon].value = data.userSelectedType;
        }

        of[frm_addr2].focus();
    };

    switch(zip_case) {
        case 1 :    //iframe을 이용하여 페이지에 끼워 넣기
            var daum_pape_id = 'daum_juso_page'+frm_zip,
                element_wrap = document.getElementById(daum_pape_id),
                currentScroll = Math.max(document.body.scrollTop, document.documentElement.scrollTop);
            if (element_wrap == null) {
                element_wrap = document.createElement("div");
                element_wrap.setAttribute("id", daum_pape_id);
                element_wrap.style.cssText = 'display:none;border:1px solid;left:0;width:100%;height:300px;margin:5px 0;position:relative;-webkit-overflow-scrolling:touch;';
                element_wrap.innerHTML = '<img src="//i1.daumcdn.net/localimg/localimages/07/postcode/320/close.png" id="btnFoldWrap" style="cursor:pointer;position:absolute;right:0px;top:-21px;z-index:1" class="close_daum_juso" alt="접기 버튼">';
                jQuery('form[name="'+frm_name+'"]').find('input[name="'+frm_addr1+'"]').before(element_wrap);
                jQuery("#"+daum_pape_id).off("click", ".close_daum_juso").on("click", ".close_daum_juso", function(e){
                    e.preventDefault();
                    jQuery(this).parent().hide();
                });
            }

            new daum.Postcode({
                oncomplete: function(data) {
                    complete_fn(data);
                    // iframe을 넣은 element를 안보이게 한다.
                    element_wrap.style.display = 'none';
                    // 우편번호 찾기 화면이 보이기 이전으로 scroll 위치를 되돌린다.
                    document.body.scrollTop = currentScroll;
                },
                // 우편번호 찾기 화면 크기가 조정되었을때 실행할 코드를 작성하는 부분.
                // iframe을 넣은 element의 높이값을 조정한다.
                onresize : function(size) {
                    element_wrap.style.height = size.height + "px";
                },
                width : '100%',
                height : '100%'
            }).embed(element_wrap);

            // iframe을 넣은 element를 보이게 한다.
            element_wrap.style.display = 'block';
            break;
        case 2 :    //새창으로 띄우기
            new daum.Postcode({
                oncomplete: function(data) {
                    complete_fn(data);
                }
            }).open();
            break;
        default :   //iframe을 이용하여 레이어 띄우기
            var rayer_id = 'daum_juso_rayer'+frm_zip,
                element_layer = document.getElementById(rayer_id);
            if (element_layer == null) {
                element_layer = document.createElement("div");
                element_layer.setAttribute("id", rayer_id);
                element_layer.style.cssText = 'display:none;border:5px solid;position:fixed;width:300px;height:460px;left:50%;margin-left:-155px;top:50%;margin-top:-235px;overflow:hidden;-webkit-overflow-scrolling:touch;z-index:10000';
                element_layer.innerHTML = '<img src="//i1.daumcdn.net/localimg/localimages/07/postcode/320/close.png" id="btnCloseLayer" style="cursor:pointer;position:absolute;right:-3px;top:-3px;z-index:1" class="close_daum_juso" alt="닫기 버튼">';
                document.body.appendChild(element_layer);
                jQuery("#"+rayer_id).off("click", ".close_daum_juso").on("click", ".close_daum_juso", function(e){
                    e.preventDefault();
                    jQuery(this).parent().hide();
                });
            }

            new daum.Postcode({
                oncomplete: function(data) {
                    complete_fn(data);
                    // iframe을 넣은 element를 안보이게 한다.
                    element_layer.style.display = 'none';
                },
                width : '100%',
                height : '100%'
            }).embed(element_layer);

            // iframe을 넣은 element를 보이게 한다.
            element_layer.style.display = 'block';
    }
}

function ChkLen() {
    var pos, pch, ch;
    var msglen = 0;
	var MsgForm = $("#msgform");
	var strData = $("#msgform textarea[name='strData']");
	var strSubject = $("#msgform input[name='strSubject']");
    // 일괄 문구 치환
    //strDataVal = strData.val().replace(/\u200b/g, '');

    var len = strData.val().length;
    for (i=0;i<len;i++){
        pos = strData.val().charAt(i);
        if (pos == ".") isNewTitle = false;

        // 자리수 계산.
        ch = escape(pos);
        if (pch == '%0D' && ch == '%0A') { } // 2byte enter (\n\r)
        else if (ch.length > 4) msglen += 2;
        else msglen++;
        pch = ch;
    }

	var isNewSubject = true; // 타이틀 자동 생성 여부.

    $("#msgform input[name='strDataCount']").val(msglen);
    
    if (msglen > 90) {
        $("#maxLength").html("1500");
        $("#divLmsTitle").css({"display":""});
		if($("#msgType").html()=="SMS") {
	        $("#msgType").html("LMS");
			alert("LMS로 전환합니다");
			if(isNewSubject) {
				strSubject.val(strData.val().slice(0,30));
			}
		}
        if (msglen > 1500) {
			alert('문자메시지는 1500바이트를 넘을 수 없습니다. 복사붙여넣기를 한 경우 글자수가 상이할 수 있으며 마지막 일정 글자수가 전송되지 않을 수 있습니다.');
		}
    } else {
		if($("#msgType").html()=="LMS") {
	        $("#msgType").html("SMS");
			alert("SMS로 전환합니다");
		}
        $("#maxLength").html("90");
        $("#divLmsTitle").css({"display":"none"});
    }
}

function chkTitle() {
    isNewSubject = false;
}

function detailOpener(dataResult) {
	
	if($("#tr_"+dataResult).hasClass("disNone")==true) {
		
		$("#tr_"+dataResult).removeClass("disNone");
	} else {
		
		$("#tr_"+dataResult).addClass("disNone");
	}
}

function onmenushow(num) {
	
	var onmenunum = $("#req_onmenu_"+num);
	var onmenubtn = $("#req_btn_"+num);
	if(onmenunum.hasClass("disNone")==true) {
		
		onmenunum.removeClass("disNone");
		onmenubtn.html("clear");
	} else {

		onmenunum.addClass("disNone");
		onmenubtn.html("more_vert");
	}

}

function gaSwitcher(using,send,event,url,setname,device,mode,jsonp) {
	
	switch(mode){
		default:
		case "ga":
			ga(send,event,url,setname,device);
			break;
		case "gtm":
			break;
	}
}

function prt_check_valid(ptype,pthis,jsonp) {
	
	switch (ptype) {
		case "email":
			p = pthis.val();
			var date_pattern = /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i;
			var alertType = 'now';
			var msg = ($.isEmptyObject(p)==true) ? "이메일을 입력해주세요." : "입력하신 이메일 형식이 올바르지 않습니다.";
			var string = 'Y';
			break;
		case "yyyy":
			p = pthis.val();
			var date_pattern = /^(19|20)\d{2}$/; 
			var string = 'number';
			break;
		case "yy":
			p = pthis.val();
			var date_pattern = /^\d{2}$/; 
			var string = 'number';
			break;
		case "mm":
			p = pthis.val();
			var date_pattern = /^(0[1-9]|1[0-2])$/; 
			var string = 'number';
			break;
		case "dd":
			p = pthis.val();
			var date_pattern = /^(0[1-9]|[12][0-9]|3[0-1])$/; 
			var string = 'number';
			break;
		case "ymd":
			p = pthis.val();
			var date_pattern = /^\d{2}-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[0-1])$/; 
			var string = 'number';
			break;
		case "yymd":
			p = pthis.val();
			var date_pattern = /^(19|20)\d{2}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[0-1])$/; 
			var string = 'number';
			break;
		case "hh":
			p = pthis.val();
			var date_pattern = /^([0-1][0-3])$/; 
			if(pthis.val()>12) {
				alert('12시간제 입니다');
			}
			var string = 'number';
			break;
		case "HH":
		case "HH_blur":
			p = pthis.val();
			var alertType = 'now';
			var date_pattern = /^([0-9]|0[0-9]|1[0-9]|2[0-3])$/; 
			if(pthis.val()>23) {
				var msg = '시각은 24시를 넘을 수 없습니다.';
				pthis.val('23');
			} else {
				if(pthis.val().length>2) {
					var msg = '2자리 이상입력할 수 없습니다';
					pthis.val(pthis.val().substring(0,1));
				} else {
					var msg = ($.isEmptyObject(p)==true) ? "시각을 입력해주세요." : "시각은 00시~23시까지 입력가능합니다.";
				}
			}
			if(ptype=="HH_blur" && pthis.val() && pthis.val()<10) {
				pthis.val('0'+pthis.val());
			}
			var string = 'number';
			break;
		case "ii":
		case "ii_blur":
			p = pthis.val();
			var alertType = 'now';
			var date_pattern = /^([0-5][0-9])$/; 
			console.log(pthis.val().length);
			if(pthis.val()>59) {
				var msg = '분은 59분을 넘을 수 없습니다.';
				pthis.val('59');
			} else {
				if(pthis.val().length>2) {
					var msg = '2자리 이상입력할 수 없습니다';
					pthis.val(pthis.val().substring(0,1));
				} else {
					var msg = ($.isEmptyObject(p)==true) ? "분을 입력해주세요." : "분은 00분~59분까지 입력가능합니다.";
				}
			}
			if(ptype=="ii_blur" && pthis.val() && pthis.val()<10) {
				pthis.val('0'+pthis.val());
			}
			var string = 'number';
			break;
		case "ss":
		case "ss_blur":
			p = pthis.val();
			var alertType = 'now';
			var date_pattern = /^([0-5][0-9])$/; 
			if(pthis.val()>59) {
				var msg = '초는 59초을 넘을 수 없습니다.';
				pthis.val('59');
			} else {
				if(pthis.val().length>2) {
					var msg = '2자리 이상입력할 수 없습니다';
					pthis.val(pthis.val().substring(0,1));
				} else {
					var msg = ($.isEmptyObject(p)==true) ? "초를 입력해주세요." : "초는 00초~59초까지 입력가능합니다.";
				}
			}
			if(ptype=="ss_blur" && pthis.val() && pthis.val()<10) {
				pthis.val('0'+pthis.val());
			}
			var string = 'number';
			break;
		case "cellphone":
			var p = pthis.val().split('-').join('');
			var alertType = 'now';
			var msg = ($.isEmptyObject(p)==true) ? "번호를 입력해주세요." : "입력하신 번호 형식이 올바르지 않습니다.";
			var date_pattern = /^((01[1|6|7|8|9])[1-9]+[0-9]{6,7})|(010[1-9][0-9]{7})$/;
			var string = 'number';
			break;
	}
	var flag = date_pattern.test(p);

	switch (string) {
		case "number":
			pthis.val(pthis.val().replace(/[^0-9]/g,""));
//			var msg = "숫자만 사용가능합니다.";
			break;
	}

	if(flag) {
		pthis.removeClass("borderAttention");
		pthis.parent().children('div.alertBox').remove();
	} else {
		if(alertType=="now") {
			pthis.parent().children('div.alertBox').remove();
			pthis.addClass("borderAttention");
			if(pthis.parent().children('div').hasClass('alertBox')==false) {
				pthis.parent().prepend('<div class="alertBox"><i class="material-icons">check_circle</i> <span>'+msg+'</span></div>');
			}
//			setTimeout(function(){ pthis.focus(); }, 10)
			return flag;
		} else {
			return flag;
		}
	}
}

//기준요일에 따른 주차구하는 함수.
//해당 주차 / 해당주차 시작날짜 / 해당주차 끝나는날짜를 리턴.
function mirCalWeek(standard,date){

	switch (standard){
		// 주차 일요일 기준
		default :
		case 0  :
			var thisDate  = new Date(date); // 입력한 날짜 정보
			var thisDay   = thisDate.getDate(); // 입력한 날짜 일수
			var week      = ["일", "월", "화", "수", "목", "금", "토"];
			var firstDay = new Date(thisDate.getFullYear(), thisDate.getMonth(), 1); // 입력한 이달의 첫일 정보
			var firstDayArrayNum = firstDay.getDay(); // 입력한 이달의 첫일 배열값
			var lastDay  = new Date(thisDate.getFullYear(), thisDate.getMonth() + 1, 0); // 입력한 이달의 마지막일 정보
			var lastDate  = lastDay.getDate(); // 입력한 이달의 마지막일 일수
			var lastDayArrayNum = lastDay.getDay(); // 입력한 이달의 마지막일 배열값
			var lastWeekStart = lastDate - lastDayArrayNum; // 마지막주 시작 일수

			switch(4 <= firstDayArrayNum){
				// 입력한 이달의 첫일이 목금토 중에 있으면 첫째주는 저번달 마지막 주로 간주
				case true :
					// 첫번째 주 개수 확인
					var firstWeekNum = 7 - firstDayArrayNum;
					// 입력한 날짜가 첫번째수에 포함되어 있을 경우
					if(thisDay <= firstWeekNum){
						var prevFirstDay = new Date(thisDate.getFullYear(), thisDate.getMonth()-1 , 1); // 입력한 이달의 첫일 정보
						var prevFirstDayArrayNum = prevFirstDay.getDay(); // 입력한 전달의 첫일 배열값
						switch(4 <= prevFirstDayArrayNum){
							// 이달의 첫번째주가 목금토일 경우
							case true :
								var calWeek = 4;
								break;
							// 이달의 첫번째주가 일월화수일 경우
							case false :
								var calWeek = 5;
								break;
						}
					} else {
						// 입력한 날짜가 마지막주 시작일 보다 작을경우
						if(thisDay < lastWeekStart){
							var calWeek = Math.ceil((thisDay - firstWeekNum)/7)+1;
						} else {
						// 마지막주에 포함 될 경우
							// 마지막주의 개수가 과반수일 경우 
							if(3 < lastDayArrayNum){
								var calWeek = Math.ceil((thisDay - firstWeekNum)/7)+1;
							} else {
							// 마지막주의 개수가 과반수가 아닐경우
								var calWeek = 1;
							}
						}
					}
					break;
				// 입력한 이달의 첫일이 일월화수 중에 있으면 첫째주는 이번달 첫째주로 간주
				case false :
					// 첫번째 주 개수 확인
					var firstWeekNum = 7 - firstDayArrayNum;
					// 입력한 날짜가 첫번째수에 포함되어 있을 경우
					if(thisDay <= firstWeekNum){
						var calWeek = 1;
					} else {
						// 입력한 날짜가 마지막주 시작일 보다 작을경우
						if(thisDay < lastWeekStart){
							var calWeek = Math.ceil((thisDay - firstWeekNum)/7)+1;
						} else {
						// 마지막주에 포함 될 경우
							// 마지막주의 개수가 과반수일 경우 
							if(3 < lastDayArrayNum){
								var calWeek = Math.ceil((thisDay - firstWeekNum)/7)+1;
							} else {
							// 마지막주의 개수가 과반수가 아닐경우
								var calWeek = 1;
							}
						}
						
					}
					break;
			}
			break;
		// 주차 월요일 기준
		case 1 :
			var thisDate  = new Date(date); // 입력한 날짜 정보
			var thisDay   = thisDate.getUTCDate(); // 입력한 날짜 일수
			var week      = ["월", "화", "수", "목", "금", "토", "일"];
			var firstDay = new Date(thisDate.getFullYear(), thisDate.getMonth(), 1); // 입력한 이달의 첫일 정보
			var firstDayArrayNum = firstDay.getUTCDay(); // 입력한 이달의 첫일 배열값
			var lastDay  = new Date(thisDate.getFullYear(), thisDate.getMonth() + 1, 0); // 입력한 이달의 마지막일 정보
			var lastDate  = lastDay.getDate(); // 입력한 이달의 마지막일 일수
			var lastDayArrayNum = lastDay.getUTCDay(); // 입력한 이달의 마지막일 배열값
			var lastWeekStart = lastDate - lastDayArrayNum; // 마지막주 시작 일수

			switch(4 <= firstDayArrayNum){
				case true :
					var firstWeekNum = 7 - firstDayArrayNum;
					if(thisDay <= firstWeekNum){
						var prevFirstDay = new Date(thisDate.getFullYear(), thisDate.getMonth()-1 , 1); // 입력한 이달의 첫일 정보
						var prevFirstDayArrayNum = prevFirstDay.getUTCDay(); // 입력한 전달의 첫일 배열값
						switch(4 <= prevFirstDayArrayNum){
							case true :
								var calWeek = 4;
								break;
							case false :
								var calWeek = 5;
								break;
						}
					} else {
						if(thisDay < lastWeekStart){
							var calWeek = Math.ceil((thisDay - firstWeekNum)/7);
						} else {
							if(3 < lastDayArrayNum){
								var calWeek = Math.ceil((thisDay - firstWeekNum)/7);
							} else {
								var calWeek = 1;
							}
						}
					}
					break;
				case false :
					var firstWeekNum = 7 - firstDayArrayNum;
					if(thisDay <= firstWeekNum){
						var calWeek = 1;
					} else {
						if(thisDay < lastWeekStart){
							var calWeek = Math.ceil((thisDay - firstWeekNum)/7);
						} else {
							if(3 < lastDayArrayNum){
								var calWeek = Math.ceil((thisDay - firstWeekNum)/7);
							} else {
								var calWeek = 1;
							}
						}
						
					}
					break;
			}
			break;
	}
	return calWeek;
}

function tgEvt(evtnum) {
	
	if($("div#evt_"+evtnum).children("div.moreBtn").text()=="닫기") {
		$("div#evt_"+evtnum).children("div").not(".fst").not(".moreBtn").addClass("disNone");
		$("div#evt_"+evtnum).children("div.moreBtn").html("더보기");
	} else {
		$("div#evt_"+evtnum).children("div").not(".fst").removeClass("disNone");
		$("div#evt_"+evtnum).children("div.moreBtn").html("닫기");
	}
}

function revers_width() {
	var getulwidth = $('#mir_quickmenu_ul_wrap > li').outerWidth(true);
	$('#mir_quickmenu_ul_wrap,#tog_quickmenu,.quickmenu_addmark').width(getulwidth);
};

function jumbPage(tglink,speed) {
	var thisposition = $(".md_"+tglink+"").offset();
	console.log(thisposition);
	$("html, body").stop().animate({scrollTop: thisposition.top},speed);
}

// 첨부파일 확장자 확인
/*
function checkImg(obj, ext){ 
	var check = false; 
	var extName = $(obj).val().substring($(obj).val().lastIndexOf(".")+1).toUpperCase(); 
	var str = ext.split(","); 
	for (var i=0;i<str.length;i++) { 
		if ( extName == $.trim(str[i]) ) { 
			check = true; 
			break; 
		} 
		else check = false; 
	} 
	if(!check){ 
		alert(ext+" 이미지 파일만 업로드 가능합니다."); 
	} 
	return check; 
} 
// 첨부파일 용량 확인 
function checkImgSize(obj, size) { 
	var check = false; 
	if(window.ActiveXObject) {//IE용인데 IE8이하는 안됨...
		var fso = new ActiveXObject("Scripting.FileSystemObject"); 
		//var filepath = document.getElementById(obj).value; 
		var filepath = obj[0].value; 
		var thefile = fso.getFile(filepath); 
		sizeinbytes = thefile.size; 
	} 
	else {//IE 외 
		//sizeinbytes = document.getElementById(obj).files[0].size; 
		sizeinbytes = obj[0].files[0].size; 
	} 
	var fSExt = new Array('Bytes', 'KB', 'MB', 'GB'); 
	var i = 0; 
	var checkSize = size; 
	while(checkSize>900) { 
		checkSize/=1024; 
		i++; 
	} 
	checkSize = (Math.round(checkSize*100)/100)+' '+fSExt[i]; 
	var fSize = sizeinbytes; 
	if(fSize > size) {
		alert("첨부파일은 "+ checkSize + " 이하로 등록가능합니다."); 
		check = false; 
	} 
	else { 
		check = true; 
	} 
	return check; 
}
*/

function uploadImgPreview(upfile) {
	// @breif 업로드 파일 읽기
	let fileInfo = document.getElementById(upfile).files[0];
	let reader = new FileReader();

	// @details INDEX #01 실행 이후, 파일의 업로드( onload )가 확인되고 나서 실행된다.
	reader.onload = function() {

		// @details 업로드한 파일의 URL을 가져온다.
		document.getElementById("preview").src = reader.result;

		// @breif 썸네일 이미지 생성
		let tempImage = new Image();    // @details drawImage 메서드에 넣기 위해 이미지 객체화
		tempImage.src = reader.result;    // @details data-uri를 이미지 객체에 주입
		tempImage.addEventListener("load", function() {

			// @breif 캔버스 위에 이미지 그리기
			let canvas = document.getElementById( "canvas" );
			let canvasContext = canvas.getContext( "2d" );

			// @breif 캔버스 크기 셋팅
			canvas.width = 240;
			canvas.height = 300;

			// @breif 캔버스 위에 이미지 그리기
			canvasContext.drawImage(
				  this	// @details 업로드한 이미지 파일의 정보
				, -10	// @details X좌표
				, -10	// @details Y좌표
				, 270	// @details 넣을 이미지의 가로 사이즈( 해당 예제는 변화를 보기위해 살짝 크게 했다. )
				, 330	// @details 넣을 이미지의 세로 사이즈( 해당 예제는 변화를 보기위해 살짝 크게 했다. )
			);
			
			// @breif 캔버스 위에 이미지 그리기
			canvasContext.stroke();
			
			// @breif 캔버스의 이미지 URL 정보를 받아 썸네일 출력
			let dataURI = canvas.toDataURL("image/jpeg");
			document.querySelector("#thumbnail").src = dataURI;
		});
	};

	if( fileInfo) {
		// @details readAsDataURL을 통해 업로드한 파일의 URL을 읽어 들인다.
		reader.readAsDataURL(fileInfo);
	}
}

function imageCenter(t,w,h)
{
	var imgWidth = w;
	var imgHeight = h;
	
	t.addClass("posAbs");
	t.css({"width":"auto", "left":"50%","top":"50%","margin-left":"-"+(imgWidth/2)+"px","margin-top":"-"+(imgHeight/2)+"px"});
}

function mirJS_isMobileDevice() {
	var phoneArray = new Array('samsung-', 'sch-', 'shw-', 'sph-', 'sgh-', 'lg-', 'canu', 'im-', 'ev-', 'iphone', 'nokia', 'blackberry', 'lgtelecom', 'natebrowser', 'sonyericsson', 'mobile', 'android', 'ipad');
	for (i = 0; i < phoneArray.length; i++) {
		if (navigator.userAgent.toLowerCase().indexOf(phoneArray[i]) > -1) {
			return true;
		}
	}
	return false;
}

function mirJS_isTabletDevice() {
	if (!mirJS_isMobileDevice()) {
		return false;
	}
	// 태블릿검사
	if (navigator.userAgent.toLowerCase().indexOf('ipad') > -1 ||
		(navigator.userAgent.toLowerCase().indexOf('android') > -1 && navigator.userAgent.toLowerCase().indexOf('mobile') == -1)) {
		return true;
	}
	// 갤럭시 탭만을 위한 리다이렉트. Mobile 이라는 단어가 안들어오게 되면 지우셔도 됨
	var galaxyTabModel = new Array('shw-');
	for (i = 0; i < galaxyTabModel.length; i++) {
		if (navigator.userAgent.toLowerCase().indexOf(galaxyTabModel[i]) > -1) {
			return true;
		}
	}
	return false;
}

function loadJavascript(url, callback, charset) {
    var head= document.getElementsByTagName('head')[0];
    var script= document.createElement('script');
    script.type= 'text/javascript';
    if (charset != null) {
        script.charset = "euc-kr";
    }
    var loaded = false;
    script.onreadystatechange= function () {
        if (this.readyState == 'loaded' || this.readyState == 'complete') {
            if (loaded) {
                return;
            }
            loaded = true;
            callback();
        }
    }
    script.onload = function () {
        callback();
    }
    script.src = url;
    head.appendChild(script);
}
/*
2021-02-07-일
다크모드 테스트, 크롬 이외 브라우저 제어 불가.
$(window).load(function() {

	
	var darkmode = window.matchMedia('prefers-color-scheme: dark').matches;
	var bgDarkmode = $("body").css("backgroud-color");
	console.log(bgDarkmode);
	if (darkmode) {
	  // It's a dark theme...
	  $("div#mir_debug").html("dark");
//	  $("body").css({"background-color":"#fefefe"});
	  console.log("dark");
	} else {
	  // It's not a dark theme...
	  $("div#mir_debug").html("light");
	  console.log("light");
	}
});
*/


function mir_yn_show(node,v,setPanel,ext)
{
	var nodeSet = $('#'+setPanel+node);
	switch(v) 
	{
		case "Y":
			nodeSet.removeClass('disNone');
			break;
		case "N":
			nodeSet.addClass('disNone');
			break;
	}
}

function mirValidatek(mode,node,tmpary,tmp,cpinfo)
{
	callDynamicEx(mode,tmpary,tmp,cpinfo,node,'html');
}

function joinCheckAll() 
{
	var tmp = $('#joinWrap input[type=text],#joinWrap input[type=password]').filter('[required]');
	tmp.addClass('check_required');
	var checker = $('#joinWrap input.check_required').siblings('span').filter('.check_required');
	//console.log(checker);
	//console.log(tmp.length + ' ' + checker.length);
	if(tmp.length == checker.length) {
		$('#joinConfirmBtn').addClass('bgBlack fcWhite').prop('disabled',false);
	} else {
		$('#joinConfirmBtn').removeClass('bgBlack fcWhite').prop('disabled',true);
	}
	//$prt_html .= '	if($(this).attr(\'required\')==\'required\') {';
	//$prt_html .= '		console.log($(this).attr(\'required\'));';
	//$prt_html .= '	}';
}

function mir_stripslashes (str) {
  return (str + '').replace(/\\(.?)/g, function (s, n1) {
    switch (n1) {
    case '\\':
      return '\\';
    case '0':
      return '\u0000';
    case '':
      return '';
    default:
      return n1;
    }
  });
}

function mir_rt_style(node,mode) {
	switch (mode)
	{
		default:
		case "prt_cate":
			$(node).addClass('b1px').removeClass('border0');
			break;
	}
}



function AddComma(num) {
    var regexp = /\B(?=(\d{3})+(?!\d))/g;
    return num.toString().replace(regexp, ",");
}